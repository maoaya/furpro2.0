<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>FutPro - Amistosos</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background: #181818; color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .container { max-width: 700px; margin: 40px auto; padding: 24px; background: #232323; border-radius: 14px; box-shadow: 0 2px 12px #0006; }
        h1 { color: #FFD700; text-align: center; margin-bottom: 24px; }
        .amistoso-card { background:#232323;border-radius:12px;padding:18px;width:340px;box-shadow:0 2px 12px #0006;display:flex;flex-direction:column;align-items:center;position:relative;margin:0 auto 18px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Gestión de Amistosos</h1>
        <form id="amistosoForm" style="background:#181818;padding:16px 20px;border-radius:10px;max-width:400px;margin:0 auto 24px;box-shadow:0 2px 8px #0004;">
            <select id="amistosoLocal" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:none;"></select>
            <select id="amistosoVisitante" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:none;"></select>
            <input type="date" id="amistosoFecha" required style="width:100%;margin-bottom:8px;padding:8px;border-radius:6px;border:none;">
            <button type="submit" style="width:100%;background:#FFD700;color:#181818;font-weight:bold;padding:10px;border-radius:6px;border:none;cursor:pointer;">Crear amistoso</button>
        </form>
        <div id="amistosoList" style="display:flex;flex-wrap:wrap;gap:18px;justify-content:center;"></div>
        <a href="homepage-instagram.html" style="display:block;text-align:center;margin-top:30px;color:#FFD700;">Volver al inicio</a>
    </div>
    <script>
    // --- Lógica avanzada de amistosos migrada ---
    function getAmistosos() {
        return JSON.parse(localStorage.getItem('futpro_amistosos')||'[]');
    }
    function saveAmistosos(arr) {
        localStorage.setItem('futpro_amistosos', JSON.stringify(arr));
    }
    function getEquipos() {
        return JSON.parse(localStorage.getItem('futpro_equipos')||'[]');
    }
    function renderAmistosos() {
        const list = document.getElementById('amistosoList');
        if (!list) return;
        list.innerHTML = '';
        const amistosos = getAmistosos();
        amistosos.forEach((a, idx) => {
            const card = document.createElement('div');
            card.className = 'amistoso-card';
            card.style = 'background:#232323;border-radius:12px;padding:18px;width:340px;box-shadow:0 2px 12px #0006;display:flex;flex-direction:column;align-items:center;position:relative;';
            let res = '';
            if (a.resultado) res = `<b style='color:#FFD700;'>${a.resultado[0]}</b> - <b style='color:#FFD700;'>${a.resultado[1]}</b>`;
            card.innerHTML = `
                <h3 style=\"color:#FFD700;margin:12px 0 4px;\">${a.local} vs ${a.visitante}</h3>
                <p style=\"color:#aaa;font-size:14px;\">${a.fecha}</p>
                <p style=\"color:#fff;font-size:15px;margin-bottom:8px;\">${res}</p>
                <div style=\"display:flex;gap:10px;justify-content:center;margin-top:8px;\">
                    <button class='btn-resultado-amistoso' data-idx='${idx}' style=\"background:#FFD700;color:#181818;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;font-size:13px;\">Registrar resultado</button>
                    <button class='btn-eliminar-amistoso' data-idx='${idx}' style=\"background:#c00;color:#fff;border:none;padding:5px 10px;border-radius:5px;cursor:pointer;font-size:13px;\">Eliminar</button>
                </div>
            `;
            list.appendChild(card);
        });
        // Botón resultado
        list.querySelectorAll('.btn-resultado-amistoso').forEach(btn => {
            btn.onclick = function() {
                const i = parseInt(this.dataset.idx);
                const amistosos = getAmistosos();
                const a = amistosos[i];
                const g1 = prompt('Goles equipo local:');
                const g2 = prompt('Goles equipo visitante:');
                if (g1===null||g2===null||isNaN(g1)||isNaN(g2)) return;
                const goles1 = parseInt(g1), goles2 = parseInt(g2);
                a.resultado = [goles1,goles2];
                amistosos[i] = a;
                saveAmistosos(amistosos);
                // Sumar logros a equipos y jugadores (puedes migrar la función sumarLogroJugadoresPorPartido si lo deseas)
                renderAmistosos();
            };
        });
        // Botón eliminar
        list.querySelectorAll('.btn-eliminar-amistoso').forEach(btn => {
            btn.onclick = function() {
                if (!confirm('¿Eliminar este amistoso?')) return;
                const i = parseInt(this.dataset.idx);
                const amistosos = getAmistosos();
                amistosos.splice(i,1);
                saveAmistosos(amistosos);
                renderAmistosos();
            };
        });
    }
    // Formulario crear amistoso
    const amistosoForm = document.getElementById('amistosoForm');
    if (amistosoForm) {
        // Llenar selects
        const equipos = getEquipos();
        const localSel = document.getElementById('amistosoLocal');
        const visSel = document.getElementById('amistosoVisitante');
        localSel.innerHTML = '<option value="">Equipo local</option>';
        visSel.innerHTML = '<option value="">Equipo visitante</option>';
        equipos.forEach(eq => {
            localSel.innerHTML += `<option value="${eq.nombre}">${eq.nombre}</option>`;
            visSel.innerHTML += `<option value="${eq.nombre}">${eq.nombre}</option>`;
        });
        amistosoForm.onsubmit = function(e) {
            e.preventDefault();
            const local = localSel.value;
            const visitante = visSel.value;
            const fecha = document.getElementById('amistosoFecha').value;
            if (!local || !visitante || local===visitante || !fecha) return alert('Completa todos los campos y elige equipos distintos');
            const amistosos = getAmistosos();
            amistosos.unshift({local, visitante, fecha});
            saveAmistosos(amistosos);
            amistosoForm.reset();
            renderAmistosos();
        };
    }
    renderAmistosos();
    </script>
</body>
</html>